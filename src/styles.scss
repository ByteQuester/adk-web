/**
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* You can add global styles to this file, and also import other style files */
@use '@angular/material' as mat;
@use '../theme-colors.scss' as theme;

html[data-theme="dark"] {
  color-scheme: dark;
  @include mat.theme((
    color: theme.$primary-palette,
    density: 0
  ));
}

html {
  font-family: 'Google Sans', 'Helvetica Neue', sans-serif !important;
} 

body {
    height: 100vh;
    margin: 0;
}

markdown p {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
}

:root {
  --mat-sys-primary: black;
  --mdc-checkbox-selected-icon-color: white;
  --mat-sys-background: #131314;
  // tab variable overrides
  --mat-tab-header-active-label-text-color: #8AB4F8;
  --mat-tab-header-active-hover-label-text-color: #8AB4F8;
  --mat-tab-header-active-focus-label-text-color: #8AB4F8;
  --mat-tab-header-label-text-weight: 500;
  --mdc-text-button-label-text-color: #89b4f8;
}

:root {
  @include mat.dialog-overrides((
    container-color: var(--dialog-surface),
    subhead-color: var(--text-primary),
  ));
}

:root {
  @include mat.progress-spinner-overrides((
    active-indicator-color: #a8c7fa,
    size: 80
  ));
}

/* Light theme */
html[data-theme="light"] {
  color-scheme: light;
  @include mat.theme((
    color: theme.$primary-palette,
    density: 0
  ));
}

/* App design tokens for dark/light surfaces and bubbles */
html[data-theme="dark"] {
  --surface-bg: #131314;
  --surface-card: #1b1b1b;
  --text-primary: #ffffff;
  --text-secondary: #9aa0a6;
  --text-accent: #8AB4F8;
  --surface-accent: rgba(138, 180, 248, 0.25);
  /* Accent system for subtle coloring */
  --accent-1: #8ab4f8;
  --accent-2: #a8c7fa;
  --focus-ring: rgba(138, 180, 248, 0.35);
  --bubble-user: #303030;
  --bubble-bot: #272727;
  --dialog-surface: #1b1b1b;
}

html[data-theme="light"] {
  --surface-bg: #f7f8fa;
  --surface-card: #ffffff;
  --text-primary: #202124;
  --text-secondary: #5f6368;
  --text-accent: #305f9d;
  --surface-accent: rgba(48, 95, 157, 0.25);
  /* Accent system tuned for light mode */
  --accent-1: #467ec2;
  --accent-2: #6ea7ea;
  --focus-ring: rgba(70, 126, 194, 0.35);
  --bubble-user: #e9eef6;
  --bubble-bot: #f1f3f4;
  --dialog-surface: #ffffff;
}

/* Global overlay/select/menu theming */
/* Ensure overlays (selects/menus) appear above local high z-index elements */
::ng-deep .cdk-overlay-container,
::ng-deep .cdk-overlay-pane {
  z-index: 20000 !important;
}
::ng-deep .mat-mdc-select-panel,
::ng-deep .mdc-menu-surface {
  background: var(--dialog-surface) !important;
  color: var(--text-primary) !important;
  border: 1px solid rgba(138, 180, 248, 0.16) !important;
  box-shadow: 0 8px 24px rgba(0,0,0,0.35), 0 2px 6px rgba(0,0,0,0.2) !important;
}

/* Ensure the list inside the panel is also opaque */
::ng-deep .mat-mdc-select-panel .mdc-list,
::ng-deep .mdc-menu-surface .mdc-list,
::ng-deep .mat-mdc-menu-content .mdc-list {
  background: var(--dialog-surface) !important;
}

::ng-deep .mat-mdc-option .mdc-list-item__primary-text {
  color: var(--text-primary) !important;
}

::ng-deep .mat-mdc-option.mdc-list-item--selected .mdc-list-item__primary-text,
::ng-deep .mat-mdc-option.mdc-list-item--activated .mdc-list-item__primary-text {
  color: var(--text-primary) !important;
}

::ng-deep .mat-mdc-option.mdc-list-item--selected,
::ng-deep .mat-mdc-option.mdc-list-item--activated,
::ng-deep .mat-mdc-option:hover {
  background: var(--surface-bg) !important;
}

/* Menus */
::ng-deep .mat-mdc-menu-panel,
::ng-deep .mat-mdc-menu-content,
::ng-deep .mat-mdc-menu-panel .mat-mdc-menu-content {
  background: var(--dialog-surface) !important;
  color: var(--text-primary) !important;
  border: 1px solid rgba(138, 180, 248, 0.16) !important;
  box-shadow: 0 8px 24px rgba(0,0,0,0.35), 0 2px 6px rgba(0,0,0,0.2) !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  isolation: isolate;
}

/* Dialogs */
::ng-deep .mat-mdc-dialog-container,
::ng-deep .mat-mdc-dialog-container .mdc-dialog__surface {
  /* Force an opaque surface to avoid blending with the page */
  background: var(--dialog-surface) !important;
  background-color: var(--dialog-surface) !important;
  color: var(--text-primary) !important;
  isolation: isolate; /* ensure backdrop-filter behind does not bleed */
}

::ng-deep .mat-mdc-dialog-container .mdc-dialog__surface {
  border: 1px solid rgba(138, 180, 248, 0.16) !important;
  border-radius: 12px !important;
  box-shadow: 0 24px 64px rgba(0,0,0,0.55), 0 4px 16px rgba(0,0,0,0.35) !important;
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
}

/* removed strong panel override */

/* Backdrop */
::ng-deep .cdk-overlay-backdrop.cdk-overlay-backdrop-showing {
  background: rgba(0,0,0,0.60) !important;
  backdrop-filter: saturate(140%) blur(3px);
}

/* Tooltips */
::ng-deep .mdc-tooltip__surface {
  background: var(--surface-card) !important;
  color: var(--text-primary) !important;
  border: 1px solid rgba(138, 180, 248, 0.16);
}